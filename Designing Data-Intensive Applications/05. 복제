# 데이터 복제 필요성
- 지리적으로 사용자와 가깝게 데이터를 유지해 지연 시간 줄이기
- 시스템의 일부에 장애가 발생해도 지속적으로 동작할 수 있게 해 가용성 높이기
- 읽기 질의를 제공하는 장비의 수를 확장해 읽기 처리량을 늘린다.

# 복제의 어려움
복제의 어려움은 복제된 데이터의 변경 처리

노드간 복제시 알고리즘 : 단일 리더(single-leader), 다중 리더(multi-leader), 리더 없는(leaderless) 복제


# 트레이드 오프

동기식 복제 vs 비동기식 복제
잘못된 복제본 처리


# 리더와 팔로워


복제 서버 (replica) : 데이터베이스의 복사본 저장하는 각 노드
쓰기 작업은 모든 복제 서버에서 진행되어야 한다. (일관적이게)
일관성을 보장하기 위하여
- 리더 기반 복제 (leader-based replication, active/passive)
- 마스터/ 슬레이브(master/slave)

## 구조 탐구
리더 (마스터, 프라이머리)
팔로워 (follower) (읽기 복제 서버(read replica) (슬레이브 2차 secondary) (핫대기 hot standby)
리더가 로컬 저장소에 새로운 데이터를 기록할 때마다 데이터 변경을 복제 로그(replication log)나 변경 스트림(change stream) 의 일부로 팔로워한테 전송
-> 로컬 복사본 갱신
클라이언트가 데이터베이스로부터 읽기시 리더, 임의 팔로워에게 질의할 수 있으나, 쓰기는 리더에게만 허용



# 복제 사용처
- 여러 관계형 데이터베이스 내장 기능이며 몽고 DB, 리싱크 DB, 에스프레소 등 일부 비관계형 데이터베이스, 카프카와 래빗MQ 의 고가용성 큐 같은 분산 메시지 브로커에도 사용
  일부 네트워크 파일 시스템과 DRBD 같은 복제 블럭 디바이스도 유사하다.



# 동기식 대 비동기식 복제
- 복제가 동기식으로 발생하는지 비동기식으로 발생하는지
- 동기식은 리더가 팔로워의 복제 완료를 기다리지만 비동기식은 리더가 팔로워의 복제 완료를 기다리지 않는다.
- 동기식 복제
    - 팔로워가 리더와 일관성 있게 최신 데이터 복사본을 가지는 것을 보장
    - 단점으로 동기팔로워가 여러 이유로 응답하지 않으면 쓰기가 처리될 수 없다.
- 비동기식 복제
    - 비동기식 복제는 내구성을 약화시키지만 많은 팔로워가 있을때, 지리적으로 분산됐다면 사용한다.
    - 완전 비동기식 복제는 모든 팔로워가 잘못되더라도 리더가 쓰기 처리를 계속 할 수 있다는 점


# 새로운 팔로워 설정
- 클라이언트는 지속적으로 데이터베이스에 기록하고 데이터는 유동적이기 때문에






























